<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>PufferLab</title>
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
</head>

<body id="main" class="web">
    <title>PufferLab</title>
    <div>
        <button type="button" id="changeMode" onclick="changeMode()">mode.dark</button>
        <label for="lang" id="changeLangLabel">lang</label>
        <select name="lang" id="changeLang" onchange="changeLang()">
            <option value="en">English üá∫üá∏</option>
            <option value="fr">Fran√ßais üá´üá∑</option>
        </select>
    </div>
    <div>
        <h1>PufferLab</h1>
        <p id="intro">main.intro</p>
    </div>

</body>
<script>
    alert("This website is under construction.");
    var changeModeBT = document.getElementById('changeMode');
    var changeLangSL = document.getElementById('changeLang');
    var changeLangLB = document.getElementById('changeLangLabel');
    var introPR = document.getElementById('intro');

    var mode = localStorage.getItem("savedMode");
    if (mode == null) {
        mode = 'mode.light'
    }

    var lang = localStorage.getItem("savedLang");
    if (lang == null) {
        lang = 'en'
    }

    /*
    var request = new XMLHttpRequest();
    request.open("GET", "lang.json", false);
    request.send(null)
    var langFile = JSON.parse(request.responseText);
    */
    const langFile =
    {
        "en": {
            "main.intro": "Welcome, you are on the PufferLab website!",
            "lang": "Language:",
            "mode.light": "Dark Mode üåë",
            "mode.dark": "Light Mode ‚òÄÔ∏è"
        },
        "fr": {
            "main.intro": "Bonjour, vous √™tes sur le site de PufferLab!",
            "lang": "Langage:",
            "mode.light": "Mode sombre üåë",
            "mode.dark": "Mode clair ‚òÄÔ∏è"
        }
    }
    console.log(langFile)

    function getLang(key) {
        let fKey = langFile[lang][key]
        return fKey;
    }

    function updateLang() {
        changeLangSL.value = lang;

        changeModeBT.innerHTML = getLang(mode);
        changeLangLB.innerHTML = getLang('lang');
        introPR.innerHTML = getLang('main.intro');
    }
    updateLang()

    function updateMode() {
        let body = document.getElementById('main');
        if (mode == 'mode.dark') {
            body.classList.add('dark');
        } else {
            body.classList.remove('dark');
        }
        changeModeBT.innerHTML = getLang(mode);
    }
    updateMode()

    function changeLang() {
        lang = changeLangSL.value;
        localStorage.setItem("savedLang", lang)
        updateLang()
    }

    function changeMode() {
        if (mode == 'mode.dark') {
            mode = 'mode.light';
        } else {
            mode = 'mode.dark'
        }
        localStorage.setItem("savedMode", mode);
        updateMode()
    }
</script>

</html>